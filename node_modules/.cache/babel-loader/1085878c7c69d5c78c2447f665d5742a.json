{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useContext, useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router';\nimport { AppContext } from '../../PasarelaCobros/Provider/StateProvider';\nimport { useSwal } from './useSwal';\nexport const useProgress = () => {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const {\n    appEnv,\n    setAppEnv\n  } = useContext(AppContext);\n  const [fetching, setFetching] = useState(false);\n  const progressId = Number(id);\n  const navigate = useNavigate();\n  const {\n    fireErrorToast\n  } = useSwal();\n\n  const createProgress = async () => {\n    try {\n      const {\n        data\n      } = await axios.post('/api/progress', {\n        step_number: 1\n      });\n      navigate(`/ventapresencial/${data.id}`);\n    } catch (e) {\n      console.log({\n        e\n      });\n      fireErrorToast(`${JSON.stringify(e, null, 2)}`);\n    } finally {\n      setFetching(false);\n    }\n  };\n\n  const getProgress = async () => {\n    axios.get(`/api/progress/${progressId}`).then(_ref => {\n      let {\n        data\n      } = _ref;\n      setAppEnv(prevState => ({ ...prevState,\n        ...data\n      }));\n    }).catch(() => {\n      createProgress();\n    }).finally(() => setFetching(false));\n  };\n\n  const updateProgress = async (values, step) => {\n    axios.put(`/api/progress/${id}`, { ...values,\n      step_number: step\n    }).then(data => {\n      console.log({\n        responseOfPut: data\n      });\n      setAppEnv(prevState => ({ ...prevState,\n        ...values\n      }));\n    }).catch(err => {\n      console.log({\n        err\n      });\n    }).finally(() => setFetching(false));\n  };\n\n  useEffect(() => {\n    setFetching(true);\n\n    if (id === undefined) {\n      createProgress();\n      return;\n    }\n\n    getProgress();\n  }, []);\n  return {\n    fetching,\n    appEnv,\n    updateProgress,\n    getProgress,\n    createProgress\n  };\n};\n\n_s(useProgress, \"we7l31VAWIRmMt1zf1rKEB4Xb/U=\", false, function () {\n  return [useParams, useNavigate, useSwal];\n});","map":{"version":3,"names":["axios","useContext","useEffect","useState","useNavigate","useParams","AppContext","useSwal","useProgress","id","appEnv","setAppEnv","fetching","setFetching","progressId","Number","navigate","fireErrorToast","createProgress","data","post","step_number","e","console","log","JSON","stringify","getProgress","get","then","prevState","catch","finally","updateProgress","values","step","put","responseOfPut","err","undefined"],"sources":["C:/xampp/htdocs/om_react/src/components/VentaPresencial/Hook/useProgress.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router';\r\nimport { AppContext } from '../../PasarelaCobros/Provider/StateProvider';\r\nimport { useSwal } from './useSwal';\r\n\r\nexport const useProgress = () => {\r\n  const { id } = useParams();\r\n  const { appEnv, setAppEnv } = useContext(AppContext);\r\n\r\n  const [fetching, setFetching] = useState(false);\r\n  const progressId = Number(id);\r\n  const navigate = useNavigate();\r\n  const { fireErrorToast } = useSwal();\r\n\r\n  const createProgress = async () => {\r\n    try {\r\n      const { data } = await axios.post('/api/progress', { step_number: 1 });\r\n      navigate(`/ventapresencial/${data.id}`);\r\n    } catch (e) {\r\n      console.log({ e });\r\n      fireErrorToast(`${JSON.stringify(e, null, 2)}`);\r\n    } finally {\r\n      setFetching(false);\r\n    }\r\n  };\r\n\r\n  const getProgress = async () => {\r\n    axios\r\n      .get(`/api/progress/${progressId}`)\r\n      .then(({ data }) => {\r\n        setAppEnv((prevState) => ({\r\n          ...prevState,\r\n          ...data,\r\n        }));\r\n      })\r\n      .catch(() => {\r\n        createProgress();\r\n      })\r\n      .finally(() => setFetching(false));\r\n  };\r\n\r\n  const updateProgress = async (values, step) => {\r\n    axios\r\n      .put(`/api/progress/${id}`, { ...values, step_number: step })\r\n      .then((data) => {\r\n        console.log({ responseOfPut: data });\r\n\r\n        setAppEnv((prevState) => ({\r\n          ...prevState,\r\n          ...values,\r\n        }));\r\n      })\r\n      .catch((err) => {\r\n        console.log({ err });\r\n      })\r\n      .finally(() => setFetching(false));\r\n  };\r\n\r\n  useEffect(() => {\r\n    setFetching(true);\r\n\r\n    if (id === undefined) {\r\n      createProgress();\r\n      return;\r\n    }\r\n\r\n    getProgress();\r\n  }, []);\r\n\r\n  return { fetching, appEnv, updateProgress, getProgress, createProgress };\r\n};\r\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;AACA,SAASC,WAAT,EAAsBC,SAAtB,QAAuC,cAAvC;AACA,SAASC,UAAT,QAA2B,6CAA3B;AACA,SAASC,OAAT,QAAwB,WAAxB;AAEA,OAAO,MAAMC,WAAW,GAAG,MAAM;EAAA;;EAC/B,MAAM;IAAEC;EAAF,IAASJ,SAAS,EAAxB;EACA,MAAM;IAAEK,MAAF;IAAUC;EAAV,IAAwBV,UAAU,CAACK,UAAD,CAAxC;EAEA,MAAM,CAACM,QAAD,EAAWC,WAAX,IAA0BV,QAAQ,CAAC,KAAD,CAAxC;EACA,MAAMW,UAAU,GAAGC,MAAM,CAACN,EAAD,CAAzB;EACA,MAAMO,QAAQ,GAAGZ,WAAW,EAA5B;EACA,MAAM;IAAEa;EAAF,IAAqBV,OAAO,EAAlC;;EAEA,MAAMW,cAAc,GAAG,YAAY;IACjC,IAAI;MACF,MAAM;QAAEC;MAAF,IAAW,MAAMnB,KAAK,CAACoB,IAAN,CAAW,eAAX,EAA4B;QAAEC,WAAW,EAAE;MAAf,CAA5B,CAAvB;MACAL,QAAQ,CAAE,oBAAmBG,IAAI,CAACV,EAAG,EAA7B,CAAR;IACD,CAHD,CAGE,OAAOa,CAAP,EAAU;MACVC,OAAO,CAACC,GAAR,CAAY;QAAEF;MAAF,CAAZ;MACAL,cAAc,CAAE,GAAEQ,IAAI,CAACC,SAAL,CAAeJ,CAAf,EAAkB,IAAlB,EAAwB,CAAxB,CAA2B,EAA/B,CAAd;IACD,CAND,SAMU;MACRT,WAAW,CAAC,KAAD,CAAX;IACD;EACF,CAVD;;EAYA,MAAMc,WAAW,GAAG,YAAY;IAC9B3B,KAAK,CACF4B,GADH,CACQ,iBAAgBd,UAAW,EADnC,EAEGe,IAFH,CAEQ,QAAc;MAAA,IAAb;QAAEV;MAAF,CAAa;MAClBR,SAAS,CAAEmB,SAAD,KAAgB,EACxB,GAAGA,SADqB;QAExB,GAAGX;MAFqB,CAAhB,CAAD,CAAT;IAID,CAPH,EAQGY,KARH,CAQS,MAAM;MACXb,cAAc;IACf,CAVH,EAWGc,OAXH,CAWW,MAAMnB,WAAW,CAAC,KAAD,CAX5B;EAYD,CAbD;;EAeA,MAAMoB,cAAc,GAAG,OAAOC,MAAP,EAAeC,IAAf,KAAwB;IAC7CnC,KAAK,CACFoC,GADH,CACQ,iBAAgB3B,EAAG,EAD3B,EAC8B,EAAE,GAAGyB,MAAL;MAAab,WAAW,EAAEc;IAA1B,CAD9B,EAEGN,IAFH,CAESV,IAAD,IAAU;MACdI,OAAO,CAACC,GAAR,CAAY;QAAEa,aAAa,EAAElB;MAAjB,CAAZ;MAEAR,SAAS,CAAEmB,SAAD,KAAgB,EACxB,GAAGA,SADqB;QAExB,GAAGI;MAFqB,CAAhB,CAAD,CAAT;IAID,CATH,EAUGH,KAVH,CAUUO,GAAD,IAAS;MACdf,OAAO,CAACC,GAAR,CAAY;QAAEc;MAAF,CAAZ;IACD,CAZH,EAaGN,OAbH,CAaW,MAAMnB,WAAW,CAAC,KAAD,CAb5B;EAcD,CAfD;;EAiBAX,SAAS,CAAC,MAAM;IACdW,WAAW,CAAC,IAAD,CAAX;;IAEA,IAAIJ,EAAE,KAAK8B,SAAX,EAAsB;MACpBrB,cAAc;MACd;IACD;;IAEDS,WAAW;EACZ,CATQ,EASN,EATM,CAAT;EAWA,OAAO;IAAEf,QAAF;IAAYF,MAAZ;IAAoBuB,cAApB;IAAoCN,WAApC;IAAiDT;EAAjD,CAAP;AACD,CAjEM;;GAAMV,W;UACIH,S,EAKED,W,EACUG,O"},"metadata":{},"sourceType":"module"}