{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useContext, useEffect, useState } from 'react';\nimport { AppContext } from '../../PasarelaCobros/Provider/StateProvider';\nimport { useProgress } from './useProgress';\nexport const useAppEnv = () => {\n  _s();\n\n  const {\n    options,\n    setOptions,\n    userInfo,\n    setUserInfo,\n    formikValues,\n    setFormikValues,\n    setAppEnv,\n    stepNumberGlobal,\n    setStepNumberGlobal\n  } = useContext(AppContext);\n  const [progressLoadedFormStep, setProgressLoadedFormStep] = useState(null);\n  const {\n    fetching: creatingProgress,\n    appEnv,\n    updateProgress\n  } = useProgress();\n\n  const setValues = _ref => {\n    let {\n      step_number,\n      ...values\n    } = _ref;\n    setFormikValues({ ...values\n    });\n    console.log({\n      values\n    });\n    setProgressLoadedFormStep(step_number);\n    const {\n      country,\n      lead\n    } = values;\n    options.sideItemOptionsVP.map(option => {\n      const sameStep = step_number === option.step || step_number >= option.step;\n\n      if (sameStep) {\n        if (country !== null && option.step === 1) {\n          option.status = 'completed';\n          option.value = country;\n        }\n\n        if (lead !== null && typeof lead !== 'undefined' && option.step === 2) {\n          const formIncomplete = Object.values(lead).includes(null);\n          option.status = formIncomplete ? 'current' : 'completed';\n          option.value = formIncomplete ? 'Sin completar' : 'Completado';\n        } else if (sameStep && option.step === 2) {\n          option.status = 'current';\n        }\n      }\n\n      return { ...option\n      };\n    });\n    setOptions({ ...options\n    });\n    const stepIndex = step_number - 1;\n    setStepNumberGlobal(stepIndex);\n  };\n\n  useEffect(() => {\n    if (appEnv != null && typeof appEnv !== 'undefined' && progressLoadedFormStep === null) {\n      console.log({\n        appEnv\n      });\n      setValues(appEnv);\n    }\n\n    return () => null;\n  }, [stepNumberGlobal, creatingProgress, formikValues]);\n\n  const saveLead = async values => {\n    const body = new FormData();\n    const requestConfig = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    };\n    let dataJson = {\n      lead: {\n        lead_id: appEnv.lead_id !== undefined ? appEnv.lead_id : null,\n        ...values\n      }\n    };\n    body.append('dataJson', JSON.stringify(dataJson));\n    const responseOfLaravel = await axios.post('http://127.0.0.1:8000/api/db/stepCreateLead', body, requestConfig);\n    console.log({\n      responseOfLaravel\n    });\n\n    if (responseOfLaravel.data.message === 'success') {\n      setAppEnv(appEnvCurrent => ({ ...appEnvCurrent,\n        lead_id: responseOfLaravel.data.newLead.id\n      }));\n    }\n\n    console.log({\n      appEnv\n    });\n  };\n\n  const saveContact = async values => {\n    console.log({\n      values\n    });\n    const body = new FormData();\n    const requestConfig = {\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded'\n      }\n    };\n    let dataJson = {\n      contact: {\n        id: appEnv.contact_id !== undefined ? appEnv.contact_id : null,\n        dni: values.dni,\n        sex: values.sex,\n        date_of_birth: values.date_of_birth,\n        registration_number: values.registration_number,\n        area_of_work: values.area_of_work,\n        training_interest: values.training_interest\n      },\n      address: {\n        id: appEnv.address_id !== undefined ? appEnv.address_id : null,\n        country: values.country,\n        province_state: values.province_state,\n        postal_code: values.postal_code,\n        street: values.street,\n        locality: values.locality\n      }\n    }; // body.append('dataJson', JSON.stringify(formik.values))\n\n    body.append('dataJson', JSON.stringify(dataJson));\n    const responseOfLaravel = await axios.post('http://127.0.0.1:8000/api/db/stepConversionContact', body, requestConfig);\n\n    if (responseOfLaravel.data.message === 'success') {\n      setAppEnv(appEnvCurrent => ({ ...appEnvCurrent,\n        contact_id: responseOfLaravel.data.newContact.id,\n        address_id: responseOfLaravel.data.newAddress.id\n      }));\n    }\n\n    console.log({\n      appEnv\n    });\n  };\n\n  return {\n    setFormikValues,\n    setAppEnv,\n    appEnv,\n    saveLead,\n    saveContact,\n    setValues,\n    creatingProgress,\n    updateProgress,\n    stepNumberGlobal,\n    setStepNumberGlobal\n  };\n};\n\n_s(useAppEnv, \"jRKmBJJGujZVleZ+7oz6MlFdvXc=\", false, function () {\n  return [useProgress];\n});","map":{"version":3,"names":["axios","useContext","useEffect","useState","AppContext","useProgress","useAppEnv","options","setOptions","userInfo","setUserInfo","formikValues","setFormikValues","setAppEnv","stepNumberGlobal","setStepNumberGlobal","progressLoadedFormStep","setProgressLoadedFormStep","fetching","creatingProgress","appEnv","updateProgress","setValues","step_number","values","console","log","country","lead","sideItemOptionsVP","map","option","sameStep","step","status","value","formIncomplete","Object","includes","stepIndex","saveLead","body","FormData","requestConfig","headers","dataJson","lead_id","undefined","append","JSON","stringify","responseOfLaravel","post","data","message","appEnvCurrent","newLead","id","saveContact","contact","contact_id","dni","sex","date_of_birth","registration_number","area_of_work","training_interest","address","address_id","province_state","postal_code","street","locality","newContact","newAddress"],"sources":["C:/xampp/htdocs/om_react/src/components/VentaPresencial/Hook/useAppEnv.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport { AppContext } from '../../PasarelaCobros/Provider/StateProvider';\r\nimport { useProgress } from './useProgress';\r\n\r\nexport const useAppEnv = () => {\r\n  const {\r\n    options,\r\n    setOptions,\r\n    userInfo,\r\n    setUserInfo,\r\n    formikValues,\r\n    setFormikValues,\r\n    setAppEnv,\r\n    stepNumberGlobal,\r\n    setStepNumberGlobal,\r\n  } = useContext(AppContext);\r\n\r\n  const [progressLoadedFormStep, setProgressLoadedFormStep] = useState(null);\r\n  const { fetching: creatingProgress, appEnv, updateProgress } = useProgress();\r\n\r\n  const setValues = ({ step_number, ...values }) => {\r\n    setFormikValues({\r\n      ...values,\r\n    });\r\n    console.log({ values });\r\n    setProgressLoadedFormStep(step_number);\r\n    const { country, lead } = values;\r\n\r\n    options.sideItemOptionsVP.map((option) => {\r\n      const sameStep =\r\n        step_number === option.step || step_number >= option.step;\r\n      if (sameStep) {\r\n        if (country !== null && option.step === 1) {\r\n          option.status = 'completed';\r\n          option.value = country;\r\n        }\r\n\r\n        if (lead !== null && typeof lead !== 'undefined' && option.step === 2) {\r\n          const formIncomplete = Object.values(lead).includes(null);\r\n          option.status = formIncomplete ? 'current' : 'completed';\r\n          option.value = formIncomplete ? 'Sin completar' : 'Completado';\r\n        } else if (sameStep && option.step === 2) {\r\n          option.status = 'current';\r\n        }\r\n      }\r\n\r\n      return { ...option };\r\n    });\r\n\r\n    setOptions({ ...options });\r\n    const stepIndex = step_number - 1;\r\n    setStepNumberGlobal(stepIndex);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (\r\n      appEnv != null &&\r\n      typeof appEnv !== 'undefined' &&\r\n      progressLoadedFormStep === null\r\n    ) {\r\n      console.log({ appEnv });\r\n      setValues(appEnv);\r\n    }\r\n\r\n    return () => null;\r\n  }, [stepNumberGlobal, creatingProgress, formikValues]);\r\n\r\n  const saveLead = async (values) => {\r\n    const body = new FormData();\r\n    const requestConfig = {\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n    };\r\n    let dataJson = {\r\n      lead: {\r\n        lead_id: appEnv.lead_id !== undefined ? appEnv.lead_id : null,\r\n        ...values,\r\n      },\r\n    };\r\n\r\n    body.append('dataJson', JSON.stringify(dataJson));\r\n\r\n    const responseOfLaravel = await axios.post(\r\n      'http://127.0.0.1:8000/api/db/stepCreateLead',\r\n      body,\r\n      requestConfig\r\n    );\r\n    console.log({ responseOfLaravel });\r\n\r\n    if (responseOfLaravel.data.message === 'success') {\r\n      setAppEnv((appEnvCurrent) => ({\r\n        ...appEnvCurrent,\r\n        lead_id: responseOfLaravel.data.newLead.id,\r\n      }));\r\n    }\r\n    console.log({ appEnv });\r\n  };\r\n\r\n  const saveContact = async (values) => {\r\n    console.log({ values });\r\n    const body = new FormData();\r\n    const requestConfig = {\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n    };\r\n    let dataJson = {\r\n      contact: {\r\n        id: appEnv.contact_id !== undefined ? appEnv.contact_id : null,\r\n        dni: values.dni,\r\n        sex: values.sex,\r\n        date_of_birth: values.date_of_birth,\r\n        registration_number: values.registration_number,\r\n        area_of_work: values.area_of_work,\r\n        training_interest: values.training_interest,\r\n      },\r\n      address: {\r\n        id: appEnv.address_id !== undefined ? appEnv.address_id : null,\r\n        country: values.country,\r\n        province_state: values.province_state,\r\n        postal_code: values.postal_code,\r\n        street: values.street,\r\n        locality: values.locality,\r\n      },\r\n    };\r\n\r\n    // body.append('dataJson', JSON.stringify(formik.values))\r\n    body.append('dataJson', JSON.stringify(dataJson));\r\n\r\n    const responseOfLaravel = await axios.post(\r\n      'http://127.0.0.1:8000/api/db/stepConversionContact',\r\n      body,\r\n      requestConfig\r\n    );\r\n\r\n    if (responseOfLaravel.data.message === 'success') {\r\n      setAppEnv((appEnvCurrent) => ({\r\n        ...appEnvCurrent,\r\n        contact_id: responseOfLaravel.data.newContact.id,\r\n        address_id: responseOfLaravel.data.newAddress.id,\r\n      }));\r\n    }\r\n\r\n    console.log({ appEnv });\r\n  };\r\n\r\n  return {\r\n    setFormikValues,\r\n    setAppEnv,\r\n    appEnv,\r\n    saveLead,\r\n    saveContact,\r\n    setValues,\r\n    creatingProgress,\r\n    updateProgress,\r\n    stepNumberGlobal,\r\n    setStepNumberGlobal,\r\n  };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}